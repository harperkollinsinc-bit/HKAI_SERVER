<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Floating YouTube Player</title>
  <style>
    body { margin: 0; font-family: sans-serif; background: #f0f0f0; }

    .floating-player {
      position: fixed;
      width: 380px;
      aspect-ratio: 16/9;
      bottom: 20px;
      right: 20px;
      border: 1px solid #ccc;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
      background: #000;
      z-index: 9999;
      transition: all 0.3s ease;
    }

    .floating-player.fullscreen {
      width: 100vw;
      height: 100vh;
      bottom: 0;
      right: 0;
      border-radius: 0;
    }

    .floating-player.minimized {
      width: 250px;
      height: 40px;
      aspect-ratio: auto;
    }

    .player-header {
      height: 32px;
      background: rgba(0,0,0,0.6);
      color: #fff;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 8px;
      cursor: grab;
      user-select: none;
    }

    .player-header button {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      font-size: 16px;
      margin-left: 4px;
    }

    .player-body {
      width: 100%;
      height: calc(100% - 32px);
      background: black;
      position: relative;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .controls {
      position: absolute;
      bottom: 8px;
      left: 8px;
      right: 8px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      z-index: 10;
    }

    .buttons {
      display: flex;
      justify-content: center;
      gap: 6px;
    }

    .buttons button {
      background: rgba(0,0,0,0.6);
      color: white;
      border: none;
      padding: 4px 8px;
      cursor: pointer;
      border-radius: 4px;
    }

    .progress-bar {
      width: 100%;
      height: 6px;
      background: #555;
      border-radius: 3px;
      cursor: pointer;
      position: relative;
    }

    .progress {
      height: 100%;
      background: #a855f7;
      width: 0%;
      border-radius: 3px;
    }
  </style>
</head>
<body>

<div class="floating-player" id="player">
  <div class="player-header" id="player-header">
    <span>Video Player</span>
    <div>
      <button id="minimize-btn">_</button>
      <button id="close-btn">X</button>
    </div>
  </div>
  <div class="player-body">
    <iframe id="youtube-iframe" src="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    <div class="controls">
      <div class="progress-bar" id="progress-bar">
        <div class="progress" id="progress"></div>
      </div>
      <div class="buttons">
        <button id="rewind-btn">-5s</button>
        <button id="forward-btn">+5s</button>
      </div>
    </div>
  </div>
</div>

<script>
  const videoId = "pCJ15nGFgVg"; // replace with your video ID
  const startTime = 10; // seconds
  const endTime = 40;   // seconds

  const playerDiv = document.getElementById("player");
  const iframe = document.getElementById("youtube-iframe");
  const progress = document.getElementById("progress");
  const progressBar = document.getElementById("progress-bar");
  const minimizeBtn = document.getElementById("minimize-btn");
  const closeBtn = document.getElementById("close-btn");
  const rewindBtn = document.getElementById("rewind-btn");
  const forwardBtn = document.getElementById("forward-btn");
  const header = document.getElementById("player-header");

  let player;
  let isMinimized = false;
  let isFullscreen = false;
  let lastTap = 0;

  // Load YouTube IFrame API
  const tag = document.createElement('script');
  tag.src = "https://www.youtube.com/iframe_api";
  document.body.appendChild(tag);

  window.onYouTubeIframeAPIReady = () => {
    player = new YT.Player('youtube-iframe', {
      videoId,
      playerVars: { controls: 0, start: startTime, modestbranding: 1 },
      events: { onReady: onPlayerReady, onStateChange: onPlayerStateChange }
    });
  };

  function onPlayerReady() {
    player.seekTo(startTime);
    player.playVideo();
    requestAnimationFrame(updateProgress);
  }

  function onPlayerStateChange(event) {
    if(event.data === YT.PlayerState.PLAYING) requestAnimationFrame(updateProgress);
  }

  function updateProgress() {
    if (!player) return;
    let t = player.getCurrentTime();
    if(t < startTime) t = startTime;
    if(endTime && t > endTime) { t = startTime; player.seekTo(startTime); }
    const duration = (endTime || player.getDuration()) - startTime;
    const percent = ((t - startTime)/duration)*100;
    progress.style.width = percent + "%";
    requestAnimationFrame(updateProgress);
  }

  // Buttons
  rewindBtn.addEventListener("click", () => {
    const t = Math.max(startTime, player.getCurrentTime() - 5);
    player.seekTo(t);
  });

  forwardBtn.addEventListener("click", () => {
    const t = Math.min(endTime || player.getDuration(), player.getCurrentTime() + 5);
    player.seekTo(t);
  });

  minimizeBtn.addEventListener("click", () => {
    isMinimized = !isMinimized;
    playerDiv.classList.toggle("minimized", isMinimized);
  });

  closeBtn.addEventListener("click", () => { playerDiv.style.display = "none"; });

  // Drag
  let offsetX, offsetY, dragging = false;
  header.addEventListener("mousedown", startDrag);
  header.addEventListener("touchstart", startDrag);

  function startDrag(e) {
    dragging = true;
    offsetX = (e.touches ? e.touches[0].clientX : e.clientX) - playerDiv.offsetLeft;
    offsetY = (e.touches ? e.touches[0].clientY : e.clientY) - playerDiv.offsetTop;
    document.addEventListener("mousemove", dragMove);
    document.addEventListener("mouseup", stopDrag);
    document.addEventListener("touchmove", dragMove);
    document.addEventListener("touchend", stopDrag);
  }

  function dragMove(e) {
    if(!dragging) return;
    const x = (e.touches ? e.touches[0].clientX : e.clientX) - offsetX;
    const y = (e.touches ? e.touches[0].clientY : e.clientY) - offsetY;
    playerDiv.style.left = x + "px";
    playerDiv.style.top = y + "px";
  }

  function stopDrag() {
    dragging = false;
    document.removeEventListener("mousemove", dragMove);
    document.removeEventListener("mouseup", stopDrag);
    document.removeEventListener("touchmove", dragMove);
    document.removeEventListener("touchend", stopDrag);
  }

  // Fullscreen toggle (double-click/tap)
  playerDiv.addEventListener("dblclick", toggleFullscreen);
  playerDiv.addEventListener("touchend", (e) => {
    const now = new Date().getTime();
    if(now - lastTap < 300) toggleFullscreen();
    lastTap = now;
  });

  function toggleFullscreen() {
    isFullscreen = !isFullscreen;
    playerDiv.classList.toggle("fullscreen", isFullscreen);
  }

  // Scrub with progress bar
  progressBar.addEventListener("click", e => {
    const rect = progressBar.getBoundingClientRect();
    const percent = (e.clientX - rect.left) / rect.width;
    const duration = (endTime || player.getDuration()) - startTime;
    player.seekTo(startTime + percent * duration);
  });

  // Keyboard shortcuts
  window.addEventListener("keydown", e => {
    if (!player) return;
    if(e.code === "Space") { e.preventDefault(); player.getPlayerState() === YT.PlayerState.PLAYING ? player.pauseVideo() : player.playVideo(); }
    if(e.code === "ArrowLeft") { const t = Math.max(startTime, player.getCurrentTime() - 5); player.seekTo(t); }
    if(e.code === "ArrowRight") { const t = Math.min(endTime || player.getDuration(), player.getCurrentTime() + 5); player.seekTo(t); }
  });
</script>

</body>
</html>
